<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EZ Note Generator</title>

<style>
body {
  font-family: Arial;
  max-width: 860px;
  margin: auto;
  padding: 18px;
  font-size: 14px;
  background:#fdfdfd;
}
.header {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  font-size: 28px;
  font-weight: bold;
  margin-bottom: 16px;
}
.note-type-buttons {
  display:flex;
  gap:8px;
  justify-content:center;
  margin-bottom:16px;
}
.note-type-buttons button {
  padding:6px 12px;
  border-radius:4px;
  border:1px solid #ccc;
  cursor:pointer;
}
.note-type-buttons button.active {
  background:#4a90e2;
  color:white;
}
.note-type-section { display:none; }
.note-type-section.active { display:block; }

label.section {
  font-weight: bold;
  margin-top: 12px;
  display: block;
}
input, select, textarea {
  padding:6px;
  margin-top:4px;
  border-radius:6px;
  border:1px solid #ccc;
}
textarea { width:100%; min-height:80px; }
.radio-group {
  display:flex;
  gap:16px;
  margin-top:6px;
}
.config-row {
  display:flex;
  gap:8px;
  align-items:center;
  margin-top:8px;
}
.arrow { font-weight:bold; }
.remove-btn {
  width:28px;
  height:28px;
  border-radius:50%;
  cursor:pointer;
}
.actions { display:flex; gap:10px; margin-top:14px; }
</style>
</head>

<body>

<div class="header">üìù EZ Note Generator</div>

<div class="note-type-buttons">
  <button id="btnIntegrationNote" class="active">Integration Note</button>
  <button id="btnCalendarNote">Calendar / Resync</button>
  <button id="btnOnboardingNote">Onboarding</button>
</div>

<!-- ================= INTEGRATION NOTE ================= -->
<div id="sectionIntegrationNote" class="note-type-section active">

<label class="section">Practice Name</label>
<input id="practiceName" placeholder="Practice name">

<label class="section">Integration Type</label>
<select id="integrationType">
  <option value="">Select</option>
  <option>Opencare Sync</option>
  <option>NexHealth API</option>
  <option>Sikka API</option>
  <option>Carestack API</option>
  <option>Denticon API</option>
  <option>OpenDental API</option>
</select>

<label class="section">Contact</label>
<input id="contactName" placeholder="Contact name">
<input id="phoneNumber" placeholder="Phone">

<label class="section">Integration Status</label>
<select id="integrationStatus">
  <option value="">Select</option>
  <option>Pending</option>
  <option>Active</option>
  <option>Stalled</option>
</select>

<label class="section">Calendar Sync Configured</label>
<div class="radio-group">
  <label><input type="radio" name="calendarSync" value="Yes"> Yes</label>
  <label><input type="radio" name="calendarSync" value="No"> No</label>
</div>

<label class="section">Configs / Operatories</label>
<div id="configsContainer"></div>
<button onclick="addConfig()">‚ûï Add Operatory</button>

<label class="section">Blocker</label>
<textarea id="blocker"></textarea>

<label class="section">Setup Summary</label>
<textarea id="setupSummary"></textarea>

<div class="actions">
  <button id="copyBtn" disabled>üìã Copy</button>
  <button id="gptFixBtn">‚úèÔ∏è Fix Grammar</button>
  <button id="saveFileBtn" disabled>üíæ Save</button>
</div>

</div>

<!-- ================= ONBOARDING ================= -->
<div id="sectionOnboardingNote" class="note-type-section">

<label class="section">Main Contact</label>
<input id="onboardContactName">

<label class="section">Sentiment</label>
<input id="onboardSentiment">

<label class="section">Tech Ability</label>
<input id="onboardTechAbility">

<label class="section">Phone</label>
<input id="onboardPhoneNumber">

<label class="section">Key Notes</label>
<textarea id="onboardKeyNotes"></textarea>

<div class="actions">
  <button id="onboardCopyBtn" disabled>üìã Copy</button>
  <button id="onboardFixGrammarBtn">‚úèÔ∏è Fix Grammar</button>
</div>

</div>

<script>
const BACKEND_URL = "https://notes-backend-yheh.onrender.com";

/* ---------- Tabs ---------- */
const tabs = [
  {btn:'btnIntegrationNote', sec:'sectionIntegrationNote'},
  {btn:'btnOnboardingNote', sec:'sectionOnboardingNote'}
];

tabs.forEach(t=>{
  document.getElementById(t.btn).onclick=()=>{
    tabs.forEach(x=>{
      document.getElementById(x.btn).classList.remove("active");
      document.getElementById(x.sec).classList.remove("active");
    });
    document.getElementById(t.btn).classList.add("active");
    document.getElementById(t.sec).classList.add("active");
  };
});

/* ---------- Configs ---------- */
function durationDropdown(){
  let html = `<select class="duration"><option value="">Duration</option>`;
  for(let i=5;i<=120;i+=5) html += `<option>${i} mins</option>`;
  return html + `</select>`;
}

function addConfig(){
  const row = document.createElement("div");
  row.className="config-row";
  row.innerHTML = `
    <input placeholder="Operatory">
    ${durationDropdown()}
    <button class="remove-btn">‚úï</button>
  `;
  row.querySelector(".remove-btn").onclick = ()=>row.remove();
  document.getElementById("configsContainer").appendChild(row);
  validateIntegration();
}

/* ---------- Integration ---------- */
function generateIntegrationNote(){
  const rows = [...document.querySelectorAll(".config-row")];
  const configs = rows.map(r=>{
    const op=r.querySelector("input").value;
    const dur=r.querySelector(".duration").value;
    return `- ${op} | ${dur}`;
  }).join("\n");

  return `
Integration Type: ${integrationType.value}
Contact: ${contactName.value}
Phone: ${phoneNumber.value}
Status: ${integrationStatus.value}

Configs:
${configs}

Blocker:
${blocker.value}

Summary:
${setupSummary.value}
`.trim();
}

function validateIntegration(){
  copyBtn.disabled = !integrationType.value;
  saveFileBtn.disabled = !integrationType.value;
}

copyBtn.onclick = ()=>{
  navigator.clipboard.writeText(generateIntegrationNote());
  alert("Copied");
};

gptFixBtn.onclick = async ()=>{
  const res = await fetch(BACKEND_URL + "/summary",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ text: setupSummary.value })
  });
  const data = await res.json();
  setupSummary.value = data.cleaned;
};

/* ---------- Onboarding ---------- */
function generateOnboardNote(){
  return `
Contact: ${onboardContactName.value}
Sentiment: ${onboardSentiment.value}
Tech Ability: ${onboardTechAbility.value}
Phone: ${onboardPhoneNumber.value}

Notes:
${onboardKeyNotes.value}
`.trim();
}

onboardCopyBtn.onclick=()=>{
  navigator.clipboard.writeText(generateOnboardNote());
  alert("Copied");
};

onboardFixGrammarBtn.onclick = async ()=>{
  const res = await fetch(BACKEND_URL + "/summary",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ text: onboardKeyNotes.value })
  });
  const data = await res.json();
  onboardKeyNotes.value = data.cleaned;
};
</script>

</body>
</html>
